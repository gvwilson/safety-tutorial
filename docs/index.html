<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<script src="https://kit.fontawesome.com/4eee35f757.js"></script>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
<link rel="stylesheet" href="github.css" type="text/css">
<link rel="stylesheet" href="tutorial.css" type="text/css">
<script defer data-domain="gvwilson.github.io/safety-tutorial" src="https://plausible.io/js/script.js"></script>
<title>Computer Security for Wary Data Scientists</title>

  </head>
  <body>
    <nav>
  <div class="row underline">
    <div class="col-2 left">
      <a class="navlink" href="#">Home</a>
    </div>
    <div class="col-10 right">
      <a href="https://github.com/gvwilson/safety-tutorial">repo</a>
      <a href="https://github.com/gvwilson/safety-tutorial/raw/main/safety-tutorial.zip">download</a>
      <a class="navlink" href="license/">license</a>
      <a class="navlink" href="conduct/">conduct</a>
      <a class="navlink" href="contributing/">contributing</a>
      <a class="navlink" href="colophon/">colophon</a>
    </div>
  </div>
</nav>

    <main>
      
  <h1>Computer Security for Wary Data Scientists</h1>
  <p class="subtitle"></p>


      <!-- ---------------------------------------------------------------- -->
<section class="aside">
<h2 class="aside">What This Is</h2>
<ul>
<li>Notes and working examples that instructors can use to perform a lesson<ul>
<li>Do <em>not</em> expect novices with no prior Python or Unix experience to be able to learn from them</li>
</ul>
</li>
<li>Musical analogy<ul>
<li>This is the chord changes and melody</li>
<li>We expect instructors to create an arrangement and/or improvise while delivering</li>
</ul>
</li>
<li>Please see <a href="./license/">the license</a> for terms of use,
    the <a href="./conduct/">Code of Conduct</a> for community standards,
    and <a href="./contributing/">these guidelines</a> for notes on contributing</li>
<li>About the author:
    <a href="https://third-bit.com/">Greg Wilson</a> is a programmer, author, and educator based in Toronto<ul>
<li>Co-founder and first Executive Director of <a href="https://carpentries.org/">Software Carpentry</a></li>
<li>Currently a senior software engineering manager at a startup in Toronto</li>
</ul>
</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="aside">
<h2 class="aside">Scope</h2>
<ul>
<li><a href="http://teachtogether.tech/en/index.html#s:process-personas">Intended audience</a><ul>
<li>Ning did a bachelor&rsquo;s degree in economics
    and now works as a data analyst for the Ministry of Health</li>
<li>They learned Python in an intensive 16-week data science bootcamp program
    and are comfortable working with Unix command-line tools,
    writing data analysis programs in Python,
and downloading data from the web to use in those programs</li>
<li>Ning wants to build real-time dashboards for people in the Ministry,
    but doesn&rsquo;t understand how to do that
without exposing confidential data or opening the Ministry up to attack</li>
<li>Their work schedule is unpredictable and highly variable,
    so they need to be able to learn a bit at a time</li>
</ul>
</li>
<li>Prerequisites<ul>
<li>Intermediate Unix command line: <code>find</code>, <code>grep</code>, shell scripts using <code>for</code></li>
<li>Data analysis with Python: Polars, Plotly, Jupyter notebooks, argparse, regular expressions</li>
<li>Using Git and GitHub on months-long projects with two or three colleagues</li>
</ul>
</li>
<li>Learning outcomes<ol>
<li>TODO</li>
</ol>
</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="aside">
<h2 class="aside">What We&rsquo;re Going to Do</h2>
<ol>
<li>Show how the basic components of the web work.</li>
<li>Build a simple application that serves up data from files and a database.</li>
<li>Fix its safety issues one by one.</li>
</ol>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="aside">
<h2 class="aside">Setup</h2>
<ul>
<li>Download <a href="https://github.com/gvwilson/safety-tutorial/raw/main/safety-tutorial.zip">the latest release</a></li>
<li>Unzip the file in a temporary directory to create:<ul>
<li><code>./src/*.*</code>: shell scripts and Python programs</li>
<li><code>./site/*.*</code>: the pages and data files used in the examples</li>
<li><code>./out/*.*</code>: expected output for examples</li>
</ul>
</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="aside">
<h2 class="aside">Start with Something Simple</h2>
<p class="inclusion"><a href="src/requests_get_motto.py">src/requests_get_motto.py</a></p>
<div class="language-py">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://gvwilson.github.io/safety-tutorial/site/motto.txt&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;body:</span><span class="se">\n</span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="inclusion"><a href="out/requests_get_motto.out">out/requests_get_motto.out</a></p>
<div class="language-plaintext">
<div class="highlight"><pre><span></span><code>status code: 200
body:
Start where you are, use what you have, help who you can.
</code></pre></div>
</div>
<ul>
<li>Use the <a href="https://requests.readthedocs.io/en/latest/"><code>requests</code></a> module (needs to be installed)</li>
<li>The URL identifies the file we want<ul>
<li>Though as we&rsquo;ll see, the server can interpret it differently</li>
</ul>
</li>
<li>Response includes:<ul>
<li><a href="#g:http_status_code">HTTP status code</a> such as 200 (OK) or 404 (Not Found)</li>
<li>The text of the response</li>
</ul>
</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="aside">
<h2 class="aside">What Just Happened</h2>
<figure id="figure_1">
<img src="img/http_lifecycle.svg" alt="HTTP request/response lifecycle"/>
<figcaption>Figure 1: Lifecycle of an HTTP request and response</figcaption>
</figure>
<ul>
<li>Open a connection to the server</li>
<li>Send an <a href="#g:http_request">HTTP request</a> for the file we want</li>
<li>Server creates a <a href="#g:http_response">response</a> that includes the contents of the file</li>
<li>Sends it back</li>
<li><code>requests</code> parses the response and creates a Python object for us</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">1: Request Structure</h2>
<p class="inclusion"><a href="src/requests_prepared_structure.py">src/requests_prepared_structure.py</a></p>
<div class="language-py">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests_toolbelt.utils</span> <span class="kn">import</span> <span class="n">dump</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://gvwilson.github.io/safety-tutorial/site/motto.txt&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dump</span><span class="o">.</span><span class="n">dump_all</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
</code></pre></div>
</div>
<p class="inclusion"><a href="out/requests_prepared_structure.out">out/requests_prepared_structure.out</a></p>
<div class="language-plaintext">
<div class="highlight"><pre><span></span><code>GET /safety-tutorial/site/motto.txt HTTP/1.1
Host: gvwilson.github.io
User-Agent: python-requests/2.31.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
</code></pre></div>
</div>
<ul>
<li>First line is <a href="#g:http_method">method</a>, URL, and protocol version</li>
<li>Every HTTP request can have <a href="#g:http_header">headers</a> with extra information</li>
<li>And optionally data being uploaded (which we will see later)</li>
<li>Yes, it&rsquo;s all just text</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">2: Response Headers</h2>
<p class="inclusion"><a href="src/show_response_headers.py">src/show_response_headers.py</a></p>
<div class="language-py">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://gvwilson.github.io/web-tutorial/site/motto.txt&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="inclusion"><a href="out/show_response_headers.out">out/show_response_headers.out</a></p>
<div class="language-plaintext">
<div class="highlight"><pre><span></span><code>Connection: keep-alive
Content-Length: 5142
Server: GitHub.com
Content-Type: text/html; charset=utf-8
permissions-policy: interest-cohort=()
ETag: W/&quot;65c56fc7-239b&quot;
Content-Security-Policy: default-src &#39;none&#39;; style-src &#39;unsafe-inline&#39;; img-src data:; connect-src &#39;self&#39;
Content-Encoding: gzip
X-GitHub-Request-Id: A08C:5A357:7CF794:9CEA06:65D13923
Accept-Ranges: bytes
Date: Sat, 17 Feb 2024 22:54:27 GMT
Via: 1.1 varnish
Age: 0
X-Served-By: cache-yyz4563-YYZ
X-Cache: MISS
X-Cache-Hits: 0
X-Timer: S1708210467.301651,VS0,VE20
Vary: Accept-Encoding
X-Fastly-Request-ID: cb16df2dfa73aaf6de87924c743dd1e50a0ce570
</code></pre></div>
</div>
<ul>
<li>Every HTTP response also has with extra information<ul>
<li>Does <em>not</em> include status code: that appears in the first line</li>
</ul>
</li>
<li>Most important for now are:<ul>
<li><code>Content-Length</code>: number of bytes in response data (i.e., how much to read)</li>
<li><code>Content-Type</code>: <a href="#g:mime_type">MIME type</a> of data (e.g., <code>text/plain</code>)</li>
</ul>
</li>
</ul>
<blockquote>
<p>From now on we will only show interesting headers</p>
</blockquote>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">3: When Things Go Wrong</h2>
<p class="inclusion"><a href="src/get_nonexistent_file.py">src/get_nonexistent_file.py</a></p>
<div class="language-py">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://gvwilson.github.io/web-tutorial/site/nonexistent.txt&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;body length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="inclusion"><a href="out/get_nonexistent_file.out">out/get_nonexistent_file.out</a></p>
<div class="language-plaintext">
<div class="highlight"><pre><span></span><code>status code: 404
body length: 9115
</code></pre></div>
</div>
<ul>
<li>The 404 status code tells us something went wrong</li>
<li>The 9 kilobyte response is an HTML page with an embedded image (the GitHub logo)</li>
<li>The page contains error messages, but we have to know page format to pull them out</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">4: Getting JSON</h2>
<p class="inclusion"><a href="src/requests_get_json.py">src/requests_get_json.py</a></p>
<div class="language-py">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://gvwilson.github.io/web-tutorial/site/motto.json&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;body as text: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>
<span class="n">as_json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;body as JSON:</span><span class="se">\n</span><span class="si">{</span><span class="n">as_json</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="inclusion"><a href="out/requests_get_json.out">out/requests_get_json.out</a></p>
<div class="language-plaintext">
<div class="highlight"><pre><span></span><code>status code: 200
body as text: 107 bytes
body as JSON:
{&#39;first&#39;: &#39;Start where you are&#39;, &#39;second&#39;: &#39;Use what you have&#39;, &#39;third&#39;: &#39;Help who you can&#39;}
</code></pre></div>
</div>
<ul>
<li>Parsing data out of HTML is called <a href="#g:web_scraping">web scraping</a><ul>
<li>Painful and error prone</li>
</ul>
</li>
<li>Better to have the server return data as data<ul>
<li>Preferred format these days is <a href="#g:json">JSON</a></li>
<li>So common that <code>requests</code> has built-in support</li>
</ul>
</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="aside">
<h2 class="aside">Local Web Server</h2>
<p class="inclusion"><a href="src/run_local_server.sh">src/run_local_server.sh</a></p>
<div class="language-sh">
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>http.server<span class="w"> </span>-d<span class="w"> </span>site
</code></pre></div>
</div>
<ul>
<li>Pushing files to GitHub so that we can use them is annoying</li>
<li>And we want to show how to make things <em>wrong</em> so that we can then make them <em>right</em></li>
<li>Use Python&rsquo;s <a href="https://docs.python.org/3/library/http.server.html"><code>http.server</code></a> module
    to run a <a href="#g:local_server">local server</a><ul>
<li>Host name is <a href="#g:localhost"><code>localhost</code></a></li>
<li>Uses port 8000 by default</li>
<li>So URLs look like <code>http://localhost:8000/path/to/file</code></li>
</ul>
</li>
<li><code>-d site</code> tells the server to pretend <code>site</code> is root directory</li>
<li>Use this local server for the next few examples<ul>
<li>Build our own server later on to show how it works</li>
</ul>
</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">5: Checking Local Server</h2>
<p class="inclusion"><a href="src/requests_local_motto.py">src/requests_local_motto.py</a></p>
<div class="language-py">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;http://localhost:8000/motto.txt&quot;</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;body:</span><span class="se">\n</span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="inclusion"><a href="out/requests_local_motto.out">out/requests_local_motto.out</a></p>
<div class="language-plaintext">
<div class="highlight"><pre><span></span><code>::ffff:127.0.0.1 - - [18/Feb/2024 09:12:24] &quot;GET /motto.txt HTTP/1.1&quot; 200 -
status code: 200
body:
Start where you are, use what you have, help who you can.
</code></pre></div>
</div>
<ul>
<li><a href="#g:concurrency">Concurrent</a> systems are hard to debug<ul>
<li>Multiple streams of activity</li>
<li>Order may change from run to run</li>
</ul>
</li>
<li>Use <code>S</code> and <code>c</code> to show output from server and client respectively</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="aside">
<h2 class="aside">Appendices</h2>
<h3>Terms</h3>
<dl class="glossary">
<dt id="g:client">client</dt><dd>A program such as a browser that sends requests to a server and does something with the response.</dd>

<dt id="g:concurrency">concurrency</dt><dd>The ability of different parts of a system to take action at the same time.</dd>

<dt id="g:http_header">header (of HTTP request or response)</dt><dd>A name-value pair at the start of an <a href="#http_request">HTTP request</a> or <a href="#http_response">response</a>. Headers are used to specify what data formats the sender can handle, the date and time the message was sent, and so on.</dd>

<dt id="g:hostname">hostname</dt><dd>A human-readable name for a computer on a network.</dd>

<dt id="g:http_method">HTTP method</dt><dd>The verb in an <a href="#http_request">HTTP request</a> that defines what the <a href="#client">client</a> wants to do. Common methods are <code>GET</code> (to get data) and <code>POST</code> (to submit data).</dd>

<dt id="g:http_request">HTTP request</dt><dd>A precisely-formatted block of text sent from a <a href="#client">client</a> such as a browser to a <a href="#server">server</a> that specifies what resource is being requested, what data formats the client will accept, etc.</dd>

<dt id="g:http_response">HTTP response</dt><dd>A precisely-formatted block of text sent from a <a href="#server">server</a> back to a <a href="#client">client</a> in reply to a <a href="#http_request">request</a>.</dd>

<dt id="g:http_status_code">HTTP status code</dt><dd>A numerical code that indicates what happened when an <a href="#http_request">HTTP request</a> was processed, such as 200 (OK), 404 (not found), or 500 (internal server error).</dd>

<dt id="g:json">JavaScript Object Notation (JSON)</dt><dd>A way to represent data by combining basic values like numbers and character strings in lists and key-value structures. Unlike other formats, it is unencumbered by a syntax for writing comments.</dd>

<dt id="g:local_server">local server</dt><dd>A <a href="#server">server</a> running on the programmer&rsquo;s own computer, typically for development purposes.</dd>

<dt id="g:localhost">localhost</dt><dd>A special <a href="#hostname">host name</a> that identifies the computer that the software is running on.</dd>

<dt id="g:mime_type">MIME type</dt><dd>A standard that defines types of file content, such as <code>text/plain</code> for plain text and <code>image/jpeg</code> for JPEG images.</dd>

<dt id="g:server">server</dt><dd>A program that waits for requests from <a href="#client">clients</a> and sends them data in response.</dd>

<dt id="g:socket">socket</dt><dd>A communication channel between two computers that provides an interface similar to reading and writing files.</dd>

<dt id="g:tls_ssl">Transport Layer Security/Secure Sockets Layer (TLS/SSL)</dt><dd>A cryptographic protocol for secure communication over a computer network.</dd>

<dt id="g:web_scraping">web scraping</dt><dd>The act of extracting data from HTML pages on the web.</dd>
</dl>
<h3>Acknowledgments</h3>
<ul><li>Jean-Marc Saffroy</li></ul>
<h3>Links</h3>
<ul>
<li><em>Teaching Tech Together</em>: <a href="https://teachtogether.tech/">https://teachtogether.tech/</a></li>
<li><em>Teaching Tech Together</em> lesson on learner personas: <a href="http://teachtogether.tech/en/index.html#s:process-personas">http://teachtogether.tech/en/index.html#s:process-personas</a></li>
<li>Python <code>http.server</code> module: <a href="https://docs.python.org/3/library/http.server.html">https://docs.python.org/3/library/http.server.html</a></li>
<li>The Carpentries: <a href="https://carpentries.org/">https://carpentries.org/</a></li>
<li><code>requests</code> module: <a href="https://requests.readthedocs.io/en/latest/">https://requests.readthedocs.io/en/latest/</a></li>
</ul>
</section>
    </main>
    <footer>
  <i class="fa fa-copyright"></i> 2024 Greg Wilson
  &middot;
  <a href="mailto:gvwilson@third-bit.com"><i class="fas fa-envelope-square" aria-hidden="true" title="author email"></i></a>
  <a href="https://github.com/gvwilson/safety-tutorial"><i class="fab fa-github" aria-hidden="true" title="GitHub repository"></i></a>
  <a href="license/"><i class="fab fa-creative-commons-by" aria-hidden="true" title="license"></i></a>
  &middot;
  <time datetime="2024-02-19">Last built 2024-02-19</time>
</footer>

  </body>
</html>
